{"ast":null,"code":"import { createSlice } from \"@reduxjs/toolkit\";\nimport AuthService from \"../../services/AuthService\";\nimport axios from \"axios\";\nimport { API_URL } from \"../../http\";\nconst initialState = {\n  user: {},\n  isAuth: false,\n  isLoading: false\n};\nexport const authSlice = createSlice({\n  name: 'auth',\n  initialState,\n  reducers: {\n    setAuth(state, action) {\n      state.isAuth = action.payload;\n    },\n    setUser(state, action) {\n      state.user = action.payload;\n    },\n    setIsLoading(state, action) {\n      state.isLoading = action.payload;\n    }\n  }\n});\nexport const {\n  setAuth,\n  setUser,\n  setIsLoading\n} = authSlice.actions;\nexport const selectAuthValue = state => state.auth.selectAuthValue;\nexport const login = (email, password) => async dispatch => {\n  try {\n    const response = await AuthService.login(email, password);\n    console.log(response);\n    localStorage.setItem(\"token\", response.data.accessToken);\n    dispatch(setAuth(true));\n    dispatch(setUser(response.data.user));\n  } catch (e) {\n    var _e$response, _e$response$data;\n    console.log((_e$response = e.response) === null || _e$response === void 0 ? void 0 : (_e$response$data = _e$response.data) === null || _e$response$data === void 0 ? void 0 : _e$response$data.message);\n  }\n};\nexport const registration = registrationData => async dispatch => {\n  try {\n    const response = await AuthService.registration(registrationData);\n    console.log(response);\n    localStorage.setItem(\"token\", response.data.accessToken);\n    dispatch(setAuth(true));\n    dispatch(setUser(response.data.user));\n  } catch (e) {\n    var _e$response2, _e$response2$data;\n    console.log((_e$response2 = e.response) === null || _e$response2 === void 0 ? void 0 : (_e$response2$data = _e$response2.data) === null || _e$response2$data === void 0 ? void 0 : _e$response2$data.message);\n  }\n};\nexport const logout = () => async dispatch => {\n  try {\n    const response = await AuthService.logout();\n    console.log(response);\n    localStorage.removeItem(\"token\");\n    dispatch(setAuth(false));\n    dispatch(setUser({}));\n  } catch (e) {\n    var _e$response3, _e$response3$data;\n    console.log((_e$response3 = e.response) === null || _e$response3 === void 0 ? void 0 : (_e$response3$data = _e$response3.data) === null || _e$response3$data === void 0 ? void 0 : _e$response3$data.message);\n  }\n};\nexport const checkAuth = () => async dispatch => {\n  dispatch(setIsLoading(true));\n  try {\n    const response = await axios.get(`${API_URL}/refresh`, {\n      withCredentials: true\n    });\n    console.log(response);\n    localStorage.setItem(\"token\", response.data.accessToken);\n    dispatch(setAuth(true));\n    dispatch(setUser(response.data.user));\n  } catch (e) {\n    var _e$response4, _e$response4$data;\n    console.log((_e$response4 = e.response) === null || _e$response4 === void 0 ? void 0 : (_e$response4$data = _e$response4.data) === null || _e$response4$data === void 0 ? void 0 : _e$response4$data.message);\n  } finally {\n    dispatch(setIsLoading(false));\n  }\n};\nexport const selectIsLoading = state => state.auth.isLoading;\nexport const selectIsAuth = state => state.auth.isAuth;\nexport const selectUser = state => state.auth.isAuth;\nexport default authSlice.reducer;","map":{"version":3,"names":["createSlice","AuthService","axios","API_URL","initialState","user","isAuth","isLoading","authSlice","name","reducers","setAuth","state","action","payload","setUser","setIsLoading","actions","selectAuthValue","auth","login","email","password","dispatch","response","console","log","localStorage","setItem","data","accessToken","e","message","registration","registrationData","logout","removeItem","checkAuth","get","withCredentials","selectIsLoading","selectIsAuth","selectUser","reducer"],"sources":["/home/user/MyLinuxProjects/delolive/frontend/src/components/globalSlices/authSlice.ts"],"sourcesContent":["import { PayloadAction, createSlice } from \"@reduxjs/toolkit\";\nimport IAuth from \"../../types/interfaces/IAuth\";\nimport { IUser } from \"../../types/interfaces/IUser\";\nimport AuthService from \"../../services/AuthService\";\nimport userModel from \"../../types/UserModel\";\nimport { AuthResponse } from \"../../types/interfaces/AuthResponse\";\nimport axios from \"axios\";\nimport { API_URL } from \"../../http\";\n\nconst initialState: IAuth = {\n    user: {} as IUser,\n    isAuth: false,\n    isLoading: false\n};\n\nexport const authSlice = createSlice({\n    name: 'auth',\n    initialState,\n    reducers: {\n        setAuth(state, action: PayloadAction<boolean>) {\n            state.isAuth = action.payload\n        },\n        setUser(state, action: PayloadAction<IUser>) {\n            state.user = action.payload\n        },\n        setIsLoading(state, action: PayloadAction<boolean>) {\n            state.isLoading = action.payload\n        }\n    }\n})\n\nexport const { setAuth, setUser, setIsLoading } = authSlice.actions;\n\nexport const selectAuthValue = (state: any) => state.auth.selectAuthValue;\n\nexport const login = (email: string, password: string) => async (dispatch: any) => {\n\n    try {\n        const response = await AuthService.login(email, password);\n        console.log(response);\n        localStorage.setItem(\"token\", response.data.accessToken);\n\n        dispatch(setAuth(true));\n        dispatch(setUser(response.data.user));\n    } catch (e: any) {\n        console.log(e.response?.data?.message);\n    }\n\n}\n\nexport const registration = (registrationData: userModel) => async (dispatch: any) => {\n\n    try {\n        const response = await AuthService.registration(registrationData);\n        console.log(response);\n        localStorage.setItem(\"token\", response.data.accessToken);\n\n        dispatch(setAuth(true));\n        dispatch(setUser(response.data.user));\n    } catch (e: any) {\n        console.log(e.response?.data?.message);\n    }\n    \n}\n\nexport const logout = () => async (dispatch: any) => {\n\n    try {\n        const response = await AuthService.logout();\n        console.log(response);\n        localStorage.removeItem(\"token\");\n\n        dispatch(setAuth(false));\n        dispatch(setUser({} as IUser));\n    } catch (e: any) {\n        console.log(e.response?.data?.message);\n    }\n    \n}\n\nexport const checkAuth = () => async (dispatch: any) => {\n    dispatch(setIsLoading(true));\n    try {\n        const response = await axios.get<AuthResponse>(`${API_URL}/refresh`, {\n            withCredentials: true,\n        });\n        console.log(response);\n        localStorage.setItem(\"token\", response.data.accessToken);\n\n        dispatch(setAuth(true));\n        dispatch(setUser(response.data.user));\n    } catch (e: any) {\n        console.log(e.response?.data?.message)\n    } finally {\n        dispatch(setIsLoading(false))\n    }\n}\n\nexport const selectIsLoading = (state: any) => state.auth.isLoading;\nexport const selectIsAuth = (state: any) => state.auth.isAuth;\nexport const selectUser = (state: any) => state.auth.isAuth;\n\nexport default authSlice.reducer;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}