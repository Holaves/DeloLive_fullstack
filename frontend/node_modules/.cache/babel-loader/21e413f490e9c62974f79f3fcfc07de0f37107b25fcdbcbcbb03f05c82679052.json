{"ast":null,"code":"import { createSlice } from \"@reduxjs/toolkit\";\nimport AuthService from \"../../services/AuthService\";\nimport axios from \"axios\";\nimport { API_URL } from \"../../http\";\nconst initialState = {\n  user: {},\n  isAuth: false,\n  isLoading: false,\n  isEmailSend: false,\n  isLoadingForm: false,\n  registrationError: '',\n  loginError: ''\n};\nexport const authSlice = createSlice({\n  name: 'auth',\n  initialState,\n  reducers: {\n    setAuth(state, action) {\n      state.isAuth = action.payload;\n    },\n    setUser(state, action) {\n      state.user = action.payload;\n    },\n    setIsLoading(state, action) {\n      state.isLoading = action.payload;\n    },\n    setIsLoadingForm(state, action) {\n      state.isLoadingForm = action.payload;\n    },\n    setIsEmailSend(state, action) {\n      state.isEmailSend = action.payload;\n    },\n    setRegistrationError(state, action) {\n      state.registrationError = action.payload;\n    },\n    setLoginError(state, action) {\n      state.loginError = action.payload;\n    }\n  }\n});\nexport const {\n  setAuth,\n  setUser,\n  setIsLoading,\n  setIsLoadingForm,\n  setIsEmailSend,\n  setRegistrationError,\n  setLoginError\n} = authSlice.actions;\nexport const login = (email, password) => async dispatch => {\n  dispatch(setIsLoadingForm(true));\n  try {\n    const response = await AuthService.login(email, password);\n    console.log(response);\n    if (response.status === 200) {\n      dispatch(setLoginError(''));\n    }\n    localStorage.setItem(\"token\", response.data.accessToken);\n    dispatch(setAuth(true));\n    dispatch(setUser(response.data.user));\n  } catch (e) {\n    var _e$response, _e$response$data, _e$response2, _e$response2$data;\n    dispatch(setLoginError((_e$response = e.response) === null || _e$response === void 0 ? void 0 : (_e$response$data = _e$response.data) === null || _e$response$data === void 0 ? void 0 : _e$response$data.message));\n    console.log((_e$response2 = e.response) === null || _e$response2 === void 0 ? void 0 : (_e$response2$data = _e$response2.data) === null || _e$response2$data === void 0 ? void 0 : _e$response2$data.message);\n  } finally {\n    dispatch(setIsLoadingForm(false));\n  }\n};\nexport const registration = registrationData => async dispatch => {\n  dispatch(setIsLoadingForm(true));\n  try {\n    const response = await AuthService.registration(registrationData);\n    console.log(response);\n    if (response.status === 200) {\n      dispatch(setIsEmailSend(true));\n      dispatch(setRegistrationError(''));\n    }\n    localStorage.setItem(\"token\", response.data.accessToken);\n    dispatch(setAuth(true));\n    dispatch(setUser(response.data.user));\n  } catch (e) {\n    var _e$response3, _e$response3$data, _e$response4, _e$response4$data;\n    console.log((_e$response3 = e.response) === null || _e$response3 === void 0 ? void 0 : (_e$response3$data = _e$response3.data) === null || _e$response3$data === void 0 ? void 0 : _e$response3$data.message);\n    dispatch(setRegistrationError((_e$response4 = e.response) === null || _e$response4 === void 0 ? void 0 : (_e$response4$data = _e$response4.data) === null || _e$response4$data === void 0 ? void 0 : _e$response4$data.message));\n  } finally {\n    dispatch(setIsLoadingForm(false));\n  }\n};\nexport const logout = () => async dispatch => {\n  try {\n    const response = await AuthService.logout();\n    console.log(response);\n    localStorage.removeItem(\"token\");\n    dispatch(setAuth(false));\n    dispatch(setUser({}));\n  } catch (e) {\n    var _e$response5, _e$response5$data;\n    console.log((_e$response5 = e.response) === null || _e$response5 === void 0 ? void 0 : (_e$response5$data = _e$response5.data) === null || _e$response5$data === void 0 ? void 0 : _e$response5$data.message);\n  }\n};\nexport const checkAuth = () => async dispatch => {\n  dispatch(setIsLoading(true));\n  try {\n    const response = await axios.get(`${API_URL}/auth/refresh`, {\n      withCredentials: true\n    });\n    console.log(response);\n    localStorage.setItem(\"token\", response.data.accessToken);\n    dispatch(setAuth(true));\n    dispatch(setUser(response.data.user));\n  } catch (e) {\n    var _e$response6, _e$response6$data;\n    console.log((_e$response6 = e.response) === null || _e$response6 === void 0 ? void 0 : (_e$response6$data = _e$response6.data) === null || _e$response6$data === void 0 ? void 0 : _e$response6$data.message);\n  } finally {\n    dispatch(setIsLoading(false));\n  }\n};\nexport const selectIsLoading = state => state.auth.isLoading;\nexport const selectIsLoadingForm = state => state.auth.isLoadingForm;\nexport const selectIsAuth = state => state.auth.isAuth;\nexport const selectUser = state => state.auth.user;\nexport const selectRegistrationError = state => state.auth.registrationError;\nexport const selectLoginError = state => state.auth.loginError;\nexport const selectIsEmailSend = state => state.auth.isEmailSend;\nexport default authSlice.reducer;","map":{"version":3,"names":["createSlice","AuthService","axios","API_URL","initialState","user","isAuth","isLoading","isEmailSend","isLoadingForm","registrationError","loginError","authSlice","name","reducers","setAuth","state","action","payload","setUser","setIsLoading","setIsLoadingForm","setIsEmailSend","setRegistrationError","setLoginError","actions","login","email","password","dispatch","response","console","log","status","localStorage","setItem","data","accessToken","e","message","registration","registrationData","logout","removeItem","checkAuth","get","withCredentials","selectIsLoading","auth","selectIsLoadingForm","selectIsAuth","selectUser","selectRegistrationError","selectLoginError","selectIsEmailSend","reducer"],"sources":["/home/user/MyLinuxProjects/delolive/frontend/src/components/globalSlices/authSlice.ts"],"sourcesContent":["import { PayloadAction, createSlice } from \"@reduxjs/toolkit\";\nimport IAuth from \"../../types/interfaces/IAuth\";\nimport { IUser } from \"../../types/interfaces/IUser\";\nimport AuthService from \"../../services/AuthService\";\nimport userModel from \"../../types/UserModel\";\nimport { AuthResponse } from \"../../types/interfaces/AuthResponse\";\nimport axios from \"axios\";\nimport { API_URL } from \"../../http\";\n\nconst initialState: IAuth = {\n    user: {} as IUser,\n    isAuth: false,\n    isLoading: false,\n    isEmailSend: false,\n    isLoadingForm: false,\n    registrationError: '',\n    loginError: ''\n};\n\nexport const authSlice = createSlice({\n    name: 'auth',\n    initialState,\n    reducers: {\n        setAuth(state, action: PayloadAction<boolean>) {\n            state.isAuth = action.payload\n        },\n        setUser(state, action: PayloadAction<IUser>) {\n            state.user = action.payload\n        },\n        setIsLoading(state, action: PayloadAction<boolean>) {\n            state.isLoading = action.payload\n        },\n        setIsLoadingForm(state, action: PayloadAction<boolean>) {\n            state.isLoadingForm = action.payload\n        },\n        setIsEmailSend(state, action: PayloadAction<boolean>) {\n            state.isEmailSend = action.payload\n        },\n        setRegistrationError(state, action: PayloadAction<string>) {\n            state.registrationError = action.payload\n        },\n        setLoginError(state, action: PayloadAction<string>) {\n            state.loginError = action.payload\n        }\n     }\n})\n\nexport const { setAuth, setUser, setIsLoading, setIsLoadingForm, setIsEmailSend, setRegistrationError, setLoginError } = authSlice.actions;\n\nexport const login = (email: string, password: string) => async (dispatch: any) => {\n    dispatch(setIsLoadingForm(true))\n    try {\n        const response = await AuthService.login(email, password);\n        console.log(response);\n        if(response.status === 200) {\n            dispatch(setLoginError(''))\n        }\n        localStorage.setItem(\"token\", response.data.accessToken);\n\n        dispatch(setAuth(true));\n        dispatch(setUser(response.data.user));\n    } catch (e: any) {\n        dispatch(setLoginError(e.response?.data?.message))\n        console.log(e.response?.data?.message);\n    } finally {\n        dispatch(setIsLoadingForm(false))\n    }\n\n}\n\nexport const registration = (registrationData: userModel) => async (dispatch: any) => {\n    dispatch(setIsLoadingForm(true))\n    try {\n        const response = await AuthService.registration(registrationData);\n        console.log(response);\n        if(response.status === 200) {\n            dispatch(setIsEmailSend(true))\n            dispatch(setRegistrationError(''))\n        }\n        localStorage.setItem(\"token\", response.data.accessToken);\n\n        dispatch(setAuth(true));\n        dispatch(setUser(response.data.user));\n    } catch (e: any) {\n        console.log(e.response?.data?.message);\n        dispatch(setRegistrationError(e.response?.data?.message))\n    } finally {\n        dispatch(setIsLoadingForm(false))\n    }\n    \n}\n\nexport const logout = () => async (dispatch: any) => {\n\n    try {\n        const response = await AuthService.logout();\n        console.log(response);\n        localStorage.removeItem(\"token\");\n\n        dispatch(setAuth(false));\n        dispatch(setUser({} as IUser));\n    } catch (e: any) {\n        console.log(e.response?.data?.message);\n    }\n    \n}\n\nexport const checkAuth = () => async (dispatch: any) => {\n    dispatch(setIsLoading(true));\n    try {\n        const response = await axios.get<AuthResponse>(`${API_URL}/auth/refresh`, {\n            withCredentials: true,\n        });\n        console.log(response);\n        localStorage.setItem(\"token\", response.data.accessToken);\n\n        dispatch(setAuth(true));\n        dispatch(setUser(response.data.user));\n    } catch (e: any) {\n        console.log(e.response?.data?.message)\n    } finally {\n        dispatch(setIsLoading(false))\n    }\n}\n\nexport const selectIsLoading = (state: any) => state.auth.isLoading;\nexport const selectIsLoadingForm = (state: any) => state.auth.isLoadingForm;\nexport const selectIsAuth = (state: any) => state.auth.isAuth;\nexport const selectUser = (state: any) => state.auth.user;\nexport const selectRegistrationError = (state: any) => state.auth.registrationError;\nexport const selectLoginError = (state: any) => state.auth.loginError;\nexport const selectIsEmailSend = (state: any) => state.auth.isEmailSend;\n\nexport default authSlice.reducer;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}